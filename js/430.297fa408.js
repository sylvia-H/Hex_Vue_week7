"use strict";(self["webpackChunkweek7_vue_project"]=self["webpackChunkweek7_vue_project"]||[]).push([[430],{8430:function(l,e,t){t.r(e),t.d(e,{default:function(){return pl}});var s=t(6252),a=t(3577);const o={class:"container py-18"},d=(0,s.uE)('<div class="row mb-6"><div class="col-12 col-lg-7"><div class="row g-0 | timeline"><div class="col-3"><div class="timeline-pointer"><h6 class="fw-light mt-5">確認訂單</h6></div></div><div class="col-3"><div class="timeline-pointer"><h6 class="fw-light mt-5">填寫訂購資訊</h6></div></div><div class="col-3"><div class="timeline-pointer"><h6 class="fw-bold mt-5">填寫付款資訊</h6></div></div><div class="col-3"><div class="timeline-pointer-undone"><h6 class="fw-light mt-5">完成訂購</h6></div></div></div></div></div>',1),n={class:"row flex-column-reverse flex-md-row"},i={class:"col-12 col-lg-7"},c={class:"table table-hover"},r=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{colspan:"2",scope:"col",class:"fz-5"},"訂單資訊")])],-1),u={class:"align-middle table-secondary"},m=(0,s._)("td",null,[(0,s._)("p",null,"訂單總金額")],-1),p={class:"d-flex justify-content-between"},_={class:"fw-bold"},h={key:0,class:"text-success fw-bold"},f={key:1,class:"text-danger fw-bold"},v={class:"align-middle"},b=(0,s._)("td",null,[(0,s._)("p",null,"訂單編號")],-1),w={class:"align-middle"},g=(0,s._)("td",null,[(0,s._)("p",null,"訂單成立日期")],-1),x={class:"align-middle"},y=(0,s._)("td",null,[(0,s._)("p",null,"訂購品項")],-1),k={class:"table table-hover table-borderless"},D=(0,s._)("thead",null,[(0,s._)("th",null,"品名"),(0,s._)("th",null,"數量"),(0,s._)("th",{class:"text-center"},"品項小計")],-1),$={class:"text-center"},z={class:"align-middle"},C=(0,s._)("td",null,[(0,s._)("p",null,"訂購人資訊")],-1),V={class:"table table-hover table-borderless"},j={class:"align-middle"},O=(0,s._)("td",null,"訂購人",-1),W={class:"align-middle"},S=(0,s._)("td",null,"E-mail",-1),q={class:"align-middle"},E=(0,s._)("td",null,"電話",-1),K={class:"align-middle"},T=(0,s._)("td",null,"地址",-1),F={class:"col-12 offset-lg-1 col-lg-4 | mb-16 mb-md-0"},M=(0,s._)("h5",null,"付款資訊",-1),U={class:"mb-10"},Y={class:"mt-5"},L=(0,s._)("span",{class:"mb-2"},"信用卡帳號",-1),N={class:"mt-5"},P=(0,s._)("span",{class:"mb-2"},"有效日期",-1),B={class:"mt-5"},H=(0,s._)("span",{class:"mb-2"},"安全碼",-1),I={class:"bg-light p-5 mt-5"},X={class:"d-flex align-items-center justify-content-between | mb-6"},Z=(0,s._)("p",null,"優惠碼",-1),A={class:"d-flex flex-column"},G={for:"couponData"},J={key:0,class:"text-end text-success mt-2"},Q={class:"d-flex justify-content-between | mb-6"},R=(0,s._)("p",null,"折扣",-1),ll={class:"fw-light"},el={class:"d-flex justify-content-between"},tl=(0,s._)("p",{class:"fz-5"},"總金額",-1),sl={class:"fz-5 fw-bold"},al={class:"row d-flex justify-content-end | my-8 my-md-4"},ol={class:"col-6"},dl=(0,s._)("button",{class:"btn btn-outline-primary w-100"}," 返回 ",-1),nl={class:"col-6"},il=["disabled"];function cl(l,e,t,cl,rl,ul){const ml=(0,s.up)("VField"),pl=(0,s.up)("ErrorMessage"),_l=(0,s.up)("router-link"),hl=(0,s.up)("VForm");return(0,s.wg)(),(0,s.iD)("div",o,[d,(0,s._)("div",n,[(0,s._)("div",i,[(0,s._)("table",c,[r,(0,s._)("tbody",null,[(0,s._)("tr",u,[m,(0,s._)("td",p,[(0,s._)("p",_,(0,a.zw)(rl.order.total)+" 元",1),rl.order.is_paid?((0,s.wg)(),(0,s.iD)("p",h," 已付款 ")):((0,s.wg)(),(0,s.iD)("p",f," 未付款 "))])]),(0,s._)("tr",v,[b,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.order.id),1)])]),(0,s._)("tr",w,[g,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(l.$filters.transferTime(rl.order.create_at)),1)])]),(0,s._)("tr",x,[y,(0,s._)("td",null,[(0,s._)("table",k,[D,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(rl.products,((l,e)=>((0,s.wg)(),(0,s.iD)("tr",{key:e,class:"align-middle"},[(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(l.product.title),1)]),(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(l.qty),1)]),(0,s._)("td",$,[(0,s._)("p",null,(0,a.zw)(l.final_total),1)])])))),128))])])])]),(0,s._)("tr",z,[C,(0,s._)("td",null,[(0,s._)("table",V,[(0,s._)("tbody",null,[(0,s._)("tr",j,[O,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.user.name),1)])]),(0,s._)("tr",W,[S,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.user.email),1)])]),(0,s._)("tr",q,[E,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.user.tel),1)])]),(0,s._)("tr",K,[T,(0,s._)("td",null,[(0,s._)("p",null,(0,a.zw)(rl.user.address),1)])])])])])])])])]),(0,s._)("div",F,[M,(0,s._)("div",U,[(0,s.Wm)(hl,{ref:"form",onSubmit:ul.submitPayment},{default:(0,s.w5)((({errors:l})=>[(0,s._)("div",Y,[L,(0,s.Wm)(ml,{rules:"required|min:16|max:19",class:"form-control",modelValue:rl.formData.credit,"onUpdate:modelValue":e[0]||(e[0]=l=>rl.formData.credit=l),id:"credit",name:"信用卡帳號",min:"16",max:"19",type:"text",placeholder:"Xxxx-xxxx-xxxx-xxxx"},null,8,["modelValue"]),(0,s.Wm)(pl,{name:"信用卡帳號",class:"d-block text-end invalid-feedback"})]),(0,s._)("div",N,[P,(0,s.Wm)(ml,{rules:"required",class:"form-control",modelValue:rl.formData.validate,"onUpdate:modelValue":e[1]||(e[1]=l=>rl.formData.validate=l),type:"month",id:"fvalidate",name:"有效日期",placeholder:"(MM/YY)"},null,8,["modelValue"]),(0,s.Wm)(pl,{name:"有效日期",class:"d-block text-end invalid-feedback"})]),(0,s._)("div",B,[H,(0,s.Wm)(ml,{rules:"required|min:3|max:4",class:"form-control",modelValue:rl.formData.fCSC,"onUpdate:modelValue":e[2]||(e[2]=l=>rl.formData.fCSC=l),type:"text",id:"fCSC",min:"3",max:"4",name:"安全碼",placeholder:"***"},null,8,["modelValue"]),(0,s.Wm)(pl,{name:"安全碼",class:"d-block text-end invalid-feedback"})]),(0,s._)("div",I,[(0,s._)("div",X,[Z,(0,s._)("div",A,[(0,s._)("label",G,[(0,s._)("input",{id:"couponData",name:"couponData",class:"form-control",type:"text",onChange:e[3]||(e[3]=(...l)=>ul.checkCoupon&&ul.checkCoupon(...l)),placeholder:"請輸入折扣優惠碼"},null,32)]),rl.is_couponOK?((0,s.wg)(),(0,s.iD)("span",J," 已套用折扣優惠碼 ")):(0,s.kq)("",!0)])]),(0,s._)("div",Q,[R,(0,s._)("p",ll," NT$ "+(0,a.zw)(rl.order.total)+" 元 ",1)]),(0,s._)("div",el,[tl,(0,s._)("p",sl,"NT$ "+(0,a.zw)(rl.order.total)+" 元",1)])]),(0,s._)("div",al,[(0,s._)("div",ol,[(0,s.Wm)(_l,{to:{name:"checkoutOrder"}},{default:(0,s.w5)((()=>[dl])),_:1})]),(0,s._)("div",nl,[(0,s._)("button",{type:"submit",disabled:Object.keys(l).length>0||!rl.formData.credit||!rl.formData.validate||!rl.formData.fCSC,class:"btn btn-danger w-100"}," 送出訂單 ",8,il)])])])),_:1},8,["onSubmit"])])])])])}var rl={data(){return{order:[],products:[],user:[],formData:{},is_couponOK:0}},methods:{getOrder(l){this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/sylviah/order/${l}`).then((l=>{console.log(l.data.order),this.order=l.data.order,Object.keys(this.order.products).forEach((l=>{this.products.push(this.order.products[`${l}`])})),this.user=this.order.user})).catch((l=>{console.log(l.response)}))},checkCoupon(){const l=document.getElementById("couponData").value,e={code:l};this.$http.post("https://vue3-course-api.hexschool.io/v2/api/sylviah/coupon",{data:e}).then((l=>{this.is_couponOK=1,console.log(l.data)})).catch((l=>{this.is_couponOK=0,console.log(l.response)}))},submitPayment(){const{id:l}=this.$route.params;this.$http.post(`https://vue3-course-api.hexschool.io/v2/api/sylviah/pay/${l}`).then((l=>{this.$refs.form.resetForm(),console.log(l.data),this.$swal.fire("成功！","已完成付款！",{icon:"success"}).then((l=>{l&&this.$router.push({name:"checkoutComplete"})}))})).catch((l=>{console.log(l.response),this.$swal.fire("失敗！","付款失敗，請再試一次！",{icon:"error"})}))},showLoading(){const l=this.$loading.show();setTimeout((()=>{l.hide()}),300)}},mounted(){const{id:l}=this.$route.params;this.getOrder(l),this.showLoading()}},ul=t(3744);const ml=(0,ul.Z)(rl,[["render",cl]]);var pl=ml}}]);
//# sourceMappingURL=430.297fa408.js.map